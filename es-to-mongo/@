import pymongo
from pymongo import MongoClient

#mongo_client = MongoClient('mongodb://Qg4vMo9Slf0wa5DEd18b26VUcJ3X7sLT@tst1-shard-00-00-icprt.mongodb.net:27017')
mongo_client = MongoClient('mongodb://nexxis-boservices-dev01:Qg4vMo9Slf0wa5DEd18b26VUcJ3X7sLT@tst1-shard-00-00-icprt.mongodb.net:27017,tst1-shard-00-01-icprt.mongodb.net:27017,tst1-shard-00-02-icprt.mongodb.net:27017/nexxis-boservices-dev01?replicaSet=tst1-shard-0&ssl=true&authSource=admin')
#mongo_client = MongoClient('mongodb://localhost:27017/')
print("Connection Successful")

'''
list_of_db = mongo_client.list_database_names()
print(list_of_db)
db_name = 'mongo_test'
if db_name in list_of_db:
    print("DB:{} Exists !!".format(db_name))
else:
    # Creating a database name GFG
    db = mongo_client['mongo_test']
    print("Database is created !!")
'''

#Getting the database instance
db = mongo_client['nexxis-boservices-dev01']
#Creating a collection
collection = db['nexxis_test']

'''
try:
    db.validate_collection(collection)  # Try to validate a collection
    print('Collection already exist')
except pymongo.errors.OperationFailure as error:  # If the collection doesn't exist
    print(error)
    print("This collection doesn't exist")
    collection = db['nexxis_test2']
    print('Collection Created')
'''
doc = {'topology': [{'interfaces': ['eth0'], 'Hostname': 'mnt-1890293133', 'guid': '151b3a32-ce00-114a-e000-0004a5081c1c', 'Gender': 'DECODER', 'Firmware': 'v1.10.01-svn12013', 'class': 'NETVIZH264TRANSCODER', 'status': 'online', 'ReleaseVersion': '-'}, {'Hostname': 'nms-19954600948', 'cluster': ['10.238.166.2', '10.238.192.2', '10.238.220.2'], 'interfaces': ['eth8'], 'version': '1.18.03-63908', 'ReleaseVersion': '1.18.03.639086585badc443a014b494207f2485635ef9c2'}, {'interfaces': ['fb_graph0ENClat_mna1x0pcie_0004A500286E', 'eth'], 'sources': [{'components': ['full'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.75:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna1x0pcie-9407211764-fb_graph0ENClat_mna1x0pcie_0004A500286E&subnet=10.238.220.0%2F24'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/fb_graph0ENClat_mna1x0pcie_0004A500286E/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/fb_graph0ENClat_mna1x0pcie_0004A500286E/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna1x0pcie-9407211764-fb_graph0ENClat_mna1x0pcie_0004A500286E&subnet=10.238.220.0%2F24&resolution=hd'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.27:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna1x0pcie-9407211764-fb_graph0ENClat_mna1x0pcie_0004A500286E&subnet=10.238.220.0%2F24&3d=true'}], 'framerate': 59999, 'kbm': False, 'source_type': 'video', 'interface': 'fb_graph0ENClat_mna1x0pcie_0004A500286E', 'resolution': '1920x1080', 'source_name': 'fb_graph0ENClat_mna1x0pcie_0004A500286E', 'aspectratio': 1.7777777777777777}], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8808, 'uuid': [], 'consistent': True}, 'refreshRate': 0, 'sink_name': 'fb_urlplayer_mna1x0pcie_0004A500286E', 'interface': 'fb_urlplayer_mna1x0pcie_0004A500286E', 'type': 'video', 'resolution': '1920x1080'}, {'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': 'fb_graph0ENClat_mna1x0pcie_0004A500286E'}], 'session-consistency': {'session': 8818, 'uuid': [], 'consistent': True}, 'refreshRate': 0, 'sink_name': 'fb_graph1DEClat_mna1x0pcie_0004A500286E', 'interface': 'fb_graph1DEClat_mna1x0pcie_0004A500286E', 'type': 'video', 'resolution': '1920x1080'}], 'Hostname': 'mna1x0pcie-0004A500286E', 'guid': 'd9b13d40-0870-1c02-e000-0004a500286e', 'Gender': 'PCIE-CARD', 'Firmware': '1.10.3-git-803067ef', 'class': 'MNA-1x0-PCIe', 'status': 'online', 'ReleaseVersion': '-'}, {'interfaces': ['eth0', 'audio2', 'dvi2', 'dvi1', 'audio1'], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8815, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'sink_name': 'mna-2530103195 0', 'interface': 'dvi1', 'type': 'video', 'resolution': '1920x1080'}, {'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8816, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'sink_name': 'mna-2530103195 1', 'interface': 'dvi2', 'type': 'video', 'resolution': '1920x1080'}, {'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8817, 'uuid': [], 'consistent': True}, 'sink_name': 'mna-2530103195 2', 'interface': 'audio2', 'type': 'audio'}], 'Hostname': 'mna-2530103195', 'guid': 'd9b13d40-0870-1c02-e000-0004a52a0ab1', 'Gender': 'DECODER', 'Firmware': 'v1.10.02-svn12015', 'class': 'NETVIZDONGLE_DVI', 'status': 'online', 'ReleaseVersion': 'v1.10.02-svn12015', 'FWStatus': 'OK', 'expVersion': '1.10.02', 'expRevision': 'svn12015'}, {'interfaces': ['audio1', 'dvi1', 'dvi2', 'audio2', 'eth0'], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8805, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'sink_name': 'mna-2530103194 0', 'interface': 'dvi1', 'type': 'video', 'resolution': '1920x1080'}, {'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8806, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'sink_name': 'mna-2530103194 1', 'interface': 'dvi2', 'type': 'video', 'resolution': '1920x1080'}, {'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8807, 'uuid': [], 'consistent': True}, 'sink_name': 'mna-2530103194 2', 'interface': 'audio2', 'type': 'audio'}], 'Hostname': 'mna-2530103194', 'guid': 'd9b13d40-0870-1c02-e000-0004a52a0abe', 'Gender': 'DECODER', 'Firmware': 'v1.10.02-svn12015', 'class': 'NETVIZDONGLE_DVI', 'status': 'online', 'ReleaseVersion': 'v1.10.02-svn12015', 'FWStatus': 'OK', 'expVersion': '1.10.02', 'expRevision': 'svn12015'}, {'interfaces': ['eth', 'audioOut', 'hdmiOut2', 'audioIn', 'hdmiOut1'], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8811, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'displayInfo': {'manufacturerProductCode': '258', 'displayName': 'MNA-420', 'manufacturerId': 'BDS'}, 'sink_name': 'mna-420-2530238535 0', 'interface': 'hdmiOut1', 'type': 'video', 'resolution': '1920x1080'}], 'Hostname': 'mna-420-2530238535', 'guid': 'd9b13d40-0870-1c02-e000-0004a5310f38', 'Gender': 'DECODER', 'Firmware': '1.5.0-22-gcbf9c9e', 'class': 'MNA-420_HDMI', 'status': 'online', 'ReleaseVersion': '-', 'FWStatus': 'OK', 'expVersion': '1.5.0', 'expRevision': '22'}, {'interfaces': ['eth', 'audioOut', 'hdmiOut1', 'hdmiOut2', 'audioIn'], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8809, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'displayInfo': {'manufacturerProductCode': '258', 'displayName': 'MNA-440', 'manufacturerId': 'BDS'}, 'sink_name': 'mna-440-2530233211 0', 'interface': 'hdmiOut1', 'type': 'video', 'resolution': '3840x2160'}, {'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8810, 'uuid': [], 'consistent': True}, 'sink_name': 'mna-440-2530233211 3', 'interface': 'audioOut', 'type': 'audio'}], 'Hostname': 'mna-440-2530233211', 'guid': 'd9b13d40-0870-1c02-e000-0004a5310f4a', 'Gender': 'DECODER', 'Firmware': '1.5.0-22-gcbf9c9e', 'class': 'MNA-440_HDMI', 'status': 'online', 'ReleaseVersion': '1.5.0-11-gfb1d689', 'FWStatus': 'OK', 'expVersion': '1.5.0', 'expRevision': '22'}, {'interfaces': ['audio2', 'eth0', 'dvi2', 'audio1', 'dvi1'], 'sources': [{'components': ['w0'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.8:5004'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi1-1-mna-2530141634/thumbnail'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.11:5901'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi1-1-mna-2530141634/thumbnail'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141634-dvi1&subnet=10.238.220.0%2F24'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141634-dvi1&subnet=10.238.220.0%2F24'}], 'framerate': 59938, 'kbm': True, 'source_type': 'video', 'interface': 'dvi1', 'resolution': '1920x1080', 'source_name': 'dvi1-1-mna-2530141634', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.4:5004'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi2-2-mna-2530141634/thumbnail'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.11:5901'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi2-2-mna-2530141634/thumbnail'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141634-dvi2&subnet=10.238.220.0%2F24'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141634-dvi2&subnet=10.238.220.0%2F24'}], 'framerate': 59934, 'kbm': False, 'source_type': 'video', 'interface': 'dvi2', 'resolution': '1920x1080', 'source_name': 'dvi2-2-mna-2530141634', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'audio/x-netviz-uncompressed', 'uri': 'udp://239.1.220.5:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141634-audio1&subnet=10.238.220.0%2F24'}], 'kbm': False, 'source_type': 'audio', 'interface': 'audio1', 'source_name': 'audio1-4-mna-2530141634'}], 'Hostname': 'mna-2530141634', 'guid': 'd9b13d40-0870-1c02-e000-0004a5371c0e', 'Gender': 'ENCODER', 'Firmware': 'v1.10.02-svn12015', 'class': 'NETVIZDONGLE_DVI', 'status': 'online', 'ReleaseVersion': 'v1.10.02-svn12015', 'FWStatus': 'OK', 'expVersion': '1.10.02', 'expRevision': 'svn12015'}, {'interfaces': ['eth0', 'audio2', 'dvi1', 'audio1', 'dvi2'], 'sources': [{'components': ['w0'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.10:5004'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi1-1-mna-2530141643/thumbnail'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.10:5901'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi1-1-mna-2530141643/thumbnail'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141643-dvi1&subnet=10.238.220.0%2F24'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141643-dvi1&subnet=10.238.220.0%2F24'}], 'framerate': 60016, 'kbm': False, 'source_type': 'video', 'interface': 'dvi1', 'resolution': '1920x1080', 'source_name': 'dvi1-1-mna-2530141643', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.11:5004'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi2-2-mna-2530141643/thumbnail'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.10:5901'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dvi2-2-mna-2530141643/thumbnail'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141643-dvi2&subnet=10.238.220.0%2F24'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141643-dvi2&subnet=10.238.220.0%2F24'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'dvi2', 'resolution': '1920x1080', 'source_name': 'dvi2-2-mna-2530141643', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'audio/x-netviz-uncompressed', 'uri': 'udp://239.1.220.12:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-2530141643-audio1&subnet=10.238.220.0%2F24'}], 'kbm': False, 'source_type': 'audio', 'interface': 'audio1', 'source_name': 'audio1-4-mna-2530141643'}], 'Hostname': 'mna-2530141643', 'guid': 'd9b13d40-0870-1c02-e000-0004a5371c18', 'Gender': 'ENCODER', 'Firmware': 'v1.10.02-svn12015', 'class': 'NETVIZDONGLE_DVI', 'status': 'online', 'ReleaseVersion': 'v1.10.02-svn12015', 'FWStatus': 'OK', 'expVersion': '1.10.02', 'expRevision': 'svn12015'}, {'interfaces': ['fb_compositor_mna1x0pcie_0004A5630BF5', 'eth'], 'sources': [{'components': ['downscaled', 'left', 'right'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.1:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna1x0pcie-9730872472-fb_compositor_mna1x0pcie_0004A5630BF5&subnet=10.238.220.0%2F24'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/fb_compositor_mna1x0pcie_0004A5630BF5/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/fb_compositor_mna1x0pcie_0004A5630BF5/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna1x0pcie-9730872472-fb_compositor_mna1x0pcie_0004A5630BF5&subnet=10.238.220.0%2F24&resolution=hd'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.3:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna1x0pcie-9730872472-fb_compositor_mna1x0pcie_0004A5630BF5&subnet=10.238.220.0%2F24&3d=true'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'fb_compositor_mna1x0pcie_0004A5630BF5', 'resolution': '3840x2160', 'source_name': 'fb_compositor_mna1x0pcie_0004A5630BF5', 'aspectratio': 1.7777777777777777}], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8804, 'uuid': [], 'consistent': True}, 'refreshRate': 0, 'sink_name': 'mnc-6491125-screen', 'interface': 'screen', 'type': 'video', 'resolution': '3840x2160'}], 'Hostname': 'mnc-6491125-screen', 'guid': 'd9b13d40-0870-1c02-e000-0004a5630bf5', 'Gender': 'COMPOSITOR', 'Firmware': '1.4.0-git-a4a625a', 'class': 'NCS', 'status': 'online', 'ReleaseVersion': '1.4.0-git-a4a625a'}, {'interfaces': ['hdmiIn2', 'audioOut', 'eth', 'audioIn', 'hdmiIn1'], 'sources': [{'components': ['downscaled', 'left', 'right', 'downscaled_3d', 'left_3d', 'right_3d'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.48:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_hdmiIn1&subnet=10.238.220.0%2F24&sapversion=2'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/hdmiIn1-0-mna-420-2530669822/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/hdmiIn1-0-mna-420-2530669822/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_hdmiIn1&subnet=10.238.220.0%2F24&resolution=hd&sapversion=2'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.16:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_hdmiIn1&subnet=10.238.220.0%2F24&sapversion=2&3d=true'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'hdmiIn1', 'resolution': '1920x1080', 'source_name': 'hdmiIn1-0-mna-420-2530669822', 'aspectratio': 1.7777777777777777}, {'components': ['downscaled', 'left', 'right', 'downscaled_3d', 'left_3d', 'right_3d'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.54:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_hdmiIn2&subnet=10.238.220.0%2F24&sapversion=2'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/hdmiIn2-2-mna-420-2530669822/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/hdmiIn2-2-mna-420-2530669822/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_hdmiIn2&subnet=10.238.220.0%2F24&resolution=hd&sapversion=2'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.16:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_hdmiIn2&subnet=10.238.220.0%2F24&sapversion=2&3d=true'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'hdmiIn2', 'resolution': '1920x1080', 'source_name': 'hdmiIn2-2-mna-420-2530669822', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'audio/x-netviz-uncompressed', 'uri': 'udp://239.1.220.47:11244'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_audioIn&subnet=10.238.220.0%2F24&sapversion=1'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-420-2530669822_audioIn&subnet=10.238.220.0%2F24&sapversion=1&3d=true'}], 'kbm': False, 'source_type': 'audio', 'interface': 'audioIn', 'source_name': 'audioIn-4-mna-420-2530669822'}], 'Hostname': 'mna-420-2530669822', 'guid': 'd9b13d40-0870-1c02-e000-0004a58a0ab4', 'Gender': 'ENCODER', 'Firmware': '1.5.0-22-gcbf9c9e', 'class': 'MNA-420_HDMI', 'status': 'online', 'ReleaseVersion': '-', 'FWStatus': 'OK', 'expVersion': '1.5.0', 'expRevision': '22'}, {'interfaces': ['eth', 'audioOut', 'hdmiIn2', 'hdmiIn1', 'audioIn'], 'sources': [{'components': ['downscaled', 'left', 'right', 'downscaled_3d', 'left_3d', 'right_3d'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.34:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-440-2530668053_hdmiIn1&subnet=10.238.220.0%2F24&sapversion=2'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/hdmiIn1-0-mna-440-2530668053/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/hdmiIn1-0-mna-440-2530668053/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-440-2530668053_hdmiIn1&subnet=10.238.220.0%2F24&resolution=hd&sapversion=2'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.23:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-440-2530668053_hdmiIn1&subnet=10.238.220.0%2F24&sapversion=2&3d=true'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'hdmiIn1', 'resolution': '3840x2160', 'source_name': 'hdmiIn1-0-mna-440-2530668053', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'audio/x-netviz-uncompressed', 'uri': 'udp://239.1.220.27:11204'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-440-2530668053_audioIn&subnet=10.238.220.0%2F24&sapversion=1'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-440-2530668053_audioIn&subnet=10.238.220.0%2F24&sapversion=1&3d=true'}], 'kbm': False, 'source_type': 'audio', 'interface': 'audioIn', 'source_name': 'audioIn-4-mna-440-2530668053'}], 'Hostname': 'mna-440-2530668053', 'guid': 'd9b13d40-0870-1c02-e000-0004a58b0a70', 'Gender': 'ENCODER', 'Firmware': '1.5.0-22-gcbf9c9e', 'class': 'MNA-440_HDMI', 'status': 'online', 'ReleaseVersion': '1.5.0-11-gfb1d689', 'FWStatus': 'OK', 'expVersion': '1.5.0', 'expRevision': '22'}, {'interfaces': ['audioOut', 'eth', 'dpIn0', 'audioIn'], 'sources': [{'components': ['downscaled', 'left', 'right'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.41:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-enc-2530626174_dpIn0&subnet=10.238.220.0%2F24&sapversion=2'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dpIn0-0-mna-240-enc-2530626174/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/dpIn0-0-mna-240-enc-2530626174/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-enc-2530626174_dpIn0&subnet=10.238.220.0%2F24&resolution=hd&sapversion=2'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.19:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-enc-2530626174_dpIn0&subnet=10.238.220.0%2F24&sapversion=2&3d=true'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'dpIn0', 'resolution': '3840x2160', 'source_name': 'dpIn0-0-mna-240-enc-2530626174', 'aspectratio': 1.7777777777777777}, {'components': ['w0'], 'children': [{'name': 'audio/x-netviz-uncompressed', 'uri': 'udp://239.1.220.40:11230'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-enc-2530626174_audioIn&subnet=10.238.220.0%2F24&sapversion=1'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-enc-2530626174_audioIn&subnet=10.238.220.0%2F24&sapversion=1&3d=true'}], 'kbm': False, 'source_type': 'audio', 'interface': 'audioIn', 'source_name': 'audioIn-4-mna-240-enc-2530626174'}], 'Hostname': 'mna-240-enc-2530626174', 'guid': 'd9b13d40-0870-1c02-e000-0cae7d2df0bb', 'Gender': 'ENCODER', 'Firmware': '2.8.0-37-gfae5aa0', 'class': 'MNA-240_DP', 'status': 'online', 'ReleaseVersion': '2.8.0-23-gc681559', 'FWStatus': 'OK', 'expVersion': '2.8.0', 'expRevision': '37'}, {'interfaces': ['fb0', 'audioIn', 'eth', 'fb1', 'audioOut'], 'sources': [{'components': ['downscaled', 'left', 'right'], 'children': [{'name': 'video/x-netviz-uncompressed', 'uri': 'udp://239.1.220.15:5004'}, {'name': 'application/x-barco-sdp-in-sap', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-2530666239_fb0&subnet=10.238.220.0%2F24&sapversion=2'}, {'name': 'multipart/x-mixed-replace', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/fb0-0-mna-240-2530666239/thumbnail'}, {'name': 'image/jpeg', 'uri': 'https://10.238.220.2:8443/barco-webservice/rest/NetworkWall/source/fb0-0-mna-240-2530666239/thumbnail'}, {'name': 'application/x-barco-downscaled', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-2530666239_fb0&subnet=10.238.220.0%2F24&resolution=hd&sapversion=2'}, {'name': 'application/x-vnc', 'uri': 'tcp://10.238.220.31:5901'}, {'name': 'application/x-barco-3d', 'uri': 'sap://224.2.127.254:9875/?s=mna-240-2530666239_fb0&subnet=10.238.220.0%2F24&sapversion=2&3d=true'}], 'framerate': 60000, 'kbm': False, 'source_type': 'video', 'interface': 'fb0', 'resolution': '3840x2160', 'source_name': 'fb0-0-mna-240-2530666239', 'aspectratio': 1.7777777777777777}], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8812, 'uuid': [], 'consistent': True}, 'refreshRate': 60000, 'displayInfo': {'manufacturerProductCode': '', 'displayName': '', 'manufacturerId': ''}, 'sink_name': 'mna-240-2530666239 0', 'interface': 'fb1', 'type': 'video', 'resolution': '3840x2160'}], 'Hostname': 'mna-240-2530666239', 'guid': 'd9b13d40-0870-1c02-e000-1442fcc58901', 'Gender': 'COMPOSITOR', 'Firmware': '2.8.0-37-gfae5aa0', 'class': 'MNA-240', 'status': 'online', 'ReleaseVersion': '2.8.0-23-gc681559'}, {'interfaces': ['dpOut0', 'audioOut', 'dviOut1', 'dviOut0', 'eth', 'audioIn'], 'sinks': [{'layout': '/Default/full.layout', 'slots': '1', 'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8813, 'uuid': [], 'consistent': True}, 'refreshRate': 60216, 'displayInfo': {'manufacturerProductCode': '258', 'displayName': 'MNA-240', 'manufacturerId': 'BDS'}, 'sink_name': 'mna-240-2530679207 2', 'interface': 'dpOut0', 'type': 'video', 'resolution': '3840x2160'}, {'conn': [{'slot': '1', 'source': ''}], 'session-consistency': {'session': 8814, 'uuid': [], 'consistent': True}, 'sink_name': 'mna-240-2530679207 3', 'interface': 'audioOut', 'type': 'audio'}], 'Hostname': 'mna-240-2530679207', 'guid': 'd9b13d40-0870-1c02-e000-d003eb6243c9', 'Gender': 'DECODER', 'Firmware': '2.8.0-37-gfae5aa0', 'class': 'MNA-240_DP', 'status': 'online', 'ReleaseVersion': '2.8.0-23-gc681559', 'FWStatus': 'OK', 'expVersion': '2.8.0', 'expRevision': '37'}], 'orId': 'DOR-BE-FDS-1', 'events': [{'registry': [['fb_graph1DEClat_mna1x0pcie_0004A500286E', '1', 'src', 'fb_graph0ENClat_mna1x0pcie_0004A500286E']]}, {'sessionupdate-display': '8818'}], 'timestamp': '2022-11-03T13:51:57.846Z'}

d = {'topology': [{'interfaces': ['eth0'], 'Hostname': 'mnt-1890293133', 'guid': '151b3a32-ce00-114a-e000-0004a5081c1c'}]}
docs = []
for i in range(2):
    d['number'] = i 
    docs.append(d)

print(docs)

collection.insert_many(docs)
mongo_client.close()
